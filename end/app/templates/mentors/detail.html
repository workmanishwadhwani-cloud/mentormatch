{% extends 'base.html' %}
{% block content %}
<div class="container py-5">
  <a href="/mentors" class="btn btn-outline-secondary mb-4">
    <i class="fa-solid fa-arrow-left me-2"></i>Back to Mentors
  </a>

  <div class="row">
    <div class="col-md-4 mb-4">
      <!-- Mentor Card -->
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4 text-center">
          <div class="mb-3">
            <div class="rounded-circle bg-gradient p-4 mx-auto" style="width: 120px; height: 120px; background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%); display: flex; align-items: center; justify-content: center;">
              <i class="fa-solid fa-chalkboard-user text-white" style="font-size: 3rem;"></i>
            </div>
          </div>
          <h3 class="fw-bold text-dark mb-2">{{ mentor.name }}</h3>
          {% if mentor.mentor_profile %}
            <p class="text-muted mb-3">{{ mentor.mentor_profile.title }}</p>
            <div class="mb-3">
              <span class="badge bg-light text-dark me-2">
                <i class="fa-solid fa-briefcase me-1"></i>{{ mentor.mentor_profile.years_of_experience }} years exp.
              </span>
            </div>
            <hr>
            <p class="text-muted small mb-3"><strong>Expertise:</strong> {{ mentor.mentor_profile.skills }}</p>
            <h5 class="text-success fw-bold">â‚¹{{ mentor.mentor_profile.hourly_rate }}<span class="text-muted fw-normal">/hour</span></h5>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="col-md-8">
      <!-- Session Booking Form -->
      {% if current_user.is_authenticated and current_user.is_student() %}
        <div class="card border-0 shadow-sm">
          <div class="card-body p-4">
            <h4 class="fw-bold text-dark mb-4">Request a Session</h4>
            <form method="post" novalidate>
              {{ form.hidden_tag() }}

              <div class="mb-4">
                {{ form.topic.label(class_='form-label fw-bold') }}
                {{ form.topic(class_='form-control form-control-lg', placeholder='e.g., Python Basics, Data Analysis') }}
                {% if form.topic.errors %}
                  <div class="text-danger small mt-2">{{ form.topic.errors[0] }}</div>
                {% endif %}
              </div>

              <div class="mb-4">
                {{ form.description.label(class_='form-label fw-bold') }}
                {{ form.description(class_='form-control form-control-lg', rows=5, placeholder='Describe what you want to learn or discuss') }}
                {% if form.description.errors %}
                  <div class="text-danger small mt-2">{{ form.description.errors[0] }}</div>
                {% endif %}
              </div>

              <div class="mb-4">
                {{ form.scheduled_at.label(class_='form-label fw-bold') }}
                {{ form.scheduled_at(class_='form-control form-control-lg') }}
                {% if form.scheduled_at.errors %}
                  <div class="text-danger small mt-2">{{ form.scheduled_at.errors[0] }}</div>
                {% endif %}
              </div>

              <button type="submit" class="btn btn-primary btn-lg w-100">
                <i class="fa-solid fa-calendar-plus me-2"></i>Request Session
              </button>
            </form>
          </div>
        </div>
      {% elif not current_user.is_authenticated %}
        <div class="card border-0 shadow-sm bg-light">
          <div class="card-body p-5 text-center">
            <i class="fa-solid fa-lock text-muted" style="font-size: 2.5rem;"></i>
            <h4 class="mt-3 fw-bold text-dark">Log in to Book</h4>
            <p class="text-muted mb-4">Sign in as a student to request a session with this mentor</p>
            <a href="/auth/login" class="btn btn-primary">Go to Login</a>
          </div>
        </div>
      {% else %}
        <div class="alert alert-info">
          <i class="fa-solid fa-circle-info me-2"></i>
          You must be logged in as a student to request a session.
        </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
